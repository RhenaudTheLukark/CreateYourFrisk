<!DOCTYPE html>
<!--
since you're here anyway: there's a small easter egg on the text commands page but it's probably not worth finding, sorry
you may notice this page's code is garbage: i'm not a web designer! ;-;
it's w3c valid, at least
-->

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>CYF Documentation - How to create a shop</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/bootstrap-theme.min.css" rel="stylesheet">
    <link href="../css/themesidebar.css" rel="stylesheet">
    <link href="../css/shThemeRDark.css" rel="stylesheet">

    <!-- Syntax highlighting -->
    <script type="text/javascript" src="../js/shCore.js"></script>
    <script type="text/javascript" src="../js/shBrushLua.js"></script>
    <script type="text/javascript">SyntaxHighlighter.all();</script>
</head>
<body>
<img src="../img/bg2.png" alt="Undertale background" class="backimg">
<div class="container arena black">
    <div class="col-md-2">
        <!--navigation-->
        <nav class="nav-sidebar">
            <ul class="nav tabs">
                <li class="li-header">Basics</li>
                    <li><a href="../documentation.html">Welcome</a></li>
                    <li><a href="howtoread.html">How to read this documentation</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li><a href="controls.html">Controls</a></li>
                    <li><a href="basic.html">Basic setup</a></li>
                    <li class="new"><a href="variables.html">Special Variables</a></li>
                    <li><a href="terms.html">Terminology</a></li>
                <li class="li-header">API</li>
                    <li class="new"><a href="api-text.html">Text commands</a></li>
                    <li class="new"><a href="api-events.html">Game events</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li class="li-indent">Functions &amp; Objects:</li>
                        <li class="li-indent new"><a href="api-functions-main.html">Misc. Functions</a></li>
                        <li class="li-indent new"><a href="api-functions-player.html">The Player Object</a></li>
                        <li class="li-indent new"><a href="api-functions-script.html">The Script Object</a></li>
                        <li class="li-indent"><a href="api-functions-audio.html">The Audio Object</a></li>
                        <li class="li-indent new"><a href="api-functions-newaudio.html"><span class="CYF"></span> The NewAudio Object</a></li>
                        <li class="li-indent new"><a href="api-functions-input.html">The Input Object</a></li>
						<li class="li-indent"><a href="api-functions-time.html">The Time Object</a></li>
                        <li class="li-indent"><a href="cyf-inventory.html"><span class="CYF"></span> The Inventory Object</a></li>
                        <li class="li-indent new"><a href="api-functions-misc.html"><span class="CYF"></span>The Misc Object</a></li>
                        <li class="li-indent new"><a href="api-functions-discord.html"><span class="CYF"></span> The Discord Object</a></li>
                        <li class="li-indent"><a href="api-functions-waves.html">The Arena Object</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li><a href="api-projectile.html">Projectile management</a></li>
                    <li><a href="cyf-ppcollision.html"><span class="CYF"></span> The Pixel-Perfect Collision System</a></li>
                    <li class="new"><a href="api-animation.html">Sprites &amp; Animation</a></li>
                    <li class="new"><a href="cyf-text.html"><span class="CYF"></span> The Text Object</a></li>
                <li class="li-header">Overworld</li>
                    <li class="new"><a href="overworld.html"><span class="CYF"></span> Basics</a></li>
                    <li><a href="overworld-howto-map.html"><span class="CYF"></span> How to create a map</a></li>
                    <li><a href="overworld-howto-event.html"><span class="CYF"></span> How to create an event</a></li>
                    <li><a href="overworld-howto-animevent.html"><span class="CYF"></span> How to animate an event</a></li>
                    <li class="active new" style="margin-left:5px;">> <span class="CYF"></span> How to create a shop <</li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li class="li-indent">Overworld Objects:</li>
                        <li class="li-indent new"><a href="overworld-object-general.html"><span class="CYF"></span> The General Object</a></li>
                        <li class="li-indent new"><a href="overworld-object-event.html"><span class="CYF"></span> The Event Object</a></li>
                        <li class="li-indent new"><a href="overworld-object-player.html"><span class="CYF"></span> The Player Object</a></li>
                        <li class="li-indent"><a href="overworld-object-screen.html"><span class="CYF"></span> The Screen Object</a></li>
                        <li class="li-indent"><a href="overworld-object-inventory.html"><span class="CYF"></span> The Inventory Object</a></li>
                        <li class="li-indent new"><a href="overworld-object-map.html"><span class="CYF"></span> The Map Object</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                <li class="li-header">Resources</li>
                    <li><a href="../media/dialogoptions.png">Dialog bubble names</a></li>
                    <li><a href="api-keys.html"><span class="CYF"></span> Key List</a></li>
            </ul>
        </nav>
    </div>
    <!--tabs'n'shit-->
    <div class="tab-content col-md-10">
		<div class="tab-pane active text-style" id="overworld-howto-shop">
            <h2><span class="CYF"></span>The Overworld: How to create a shop</h2><br><br>

            <p>
                You may know what a shop is in Undertale. Well, here you'll learn how to make one in Create Your Frisk!
                <br><br>
                Shop scripts contain some of the same functions and objects that are in all scripts, such as the <span class="term">Audio</span> object,
                the <span class="term">NewAudio</span> object, the <span class="term">Inventory</span> object, the <span class="term">Input</span> object,
                the <span class="term">Misc</span> object, and the <span class="term">Time</span> object, as well as <span class="term">RealGlobals</span>
                and <span class="term">AlMightyGlobals</span>.
                <br>The variables <span class="term">isCYF</span>, <span class="term">safe</span>, <span class="term">windows</span>
                and <span class="term">CYFversion</span> are also accessible (see <span class="ref">Overworld - Basics</span>).
                <br><br>
                <span class="new"></span>Finally, the functions <span class="term">CreateSprite</span>, <span class="term">CreateLayer</span> and
                <span class="term">CreateText</span> are all accessible (see <span class="ref">Overworld - Basics</span> for differences in functionality),
                as well as the <span class="ref">Game Event</span> <span class="term">OnTextAdvance</span>.
                <br><br>
                <h4><span style="color:#aa0000;line-height:30px;"><u>CAUTION! You will need to code in C# for some aspects of this feature!</u></span></h4>
                In the future, Items will be defined in a Lua file, along with the rest of the Overworld. Until then, if you wish to use this feature
                in your CYF fangame, you will need to read <a href="overworld.html">Overworld - Basics</a> to learn how to open this project in Unity,
                edit its source code, and build it.
            </p>
            <hr>
			<p>
				Shop scripts have their own State system. You can't directly access them, but here is a list of the shop's states:
				<ul>
					<li><span class="term">MENU</span> - The main menu of the Shop script.</li>
					<li><span class="term">BUY</span> - The Buy menu of the Shop script.</li>
					<li><span class="term">BUYCONFIRM</span> - State for confirming a purchase when buying an item.</li>
					<li><span class="term">SELL</span> -The Sell menu of the Shop script.</li>
					<li><span class="term">SELLCONFIRM</span> - State for confirming a sale when selling an item.</li>
					<li><span class="term">TALK</span> - The Talk menu of the Shop script.</li>
					<li><span class="term">TALKINPROGRESS</span> - Entered when a Talk option is chosen and its assigned text is displayed.</li>
					<li><span class="term">EXIT</span> - Entered while showing the exit text of the shop, just before leaving.</li>
					<li><span class="term">INTERRUPT</span> - Entered when interrupting the action of any other state. See the function
					<span class="term">Interrupt()</span> for more details.</li>
				</ul>
			</p>
			<p>
				If you don't know what to do or where to start, I suggest you look at the file <span class="term">Examples 2/Lua/Shops/Dummy.lua</span> to
				visualize how it's done.
			</p>
			<p>
				Other than that, other functions and variables are available, to personalize your shop. The following is a detailed list of those.<br>
			</p>
            <hr>
			<h3>Setting up your shop for use in the overworld</h3>
			<p>
				CYF's shops are different from what you've seen so far.<br>
                Your shop scripts are to be put in the directory <span class="term">YOURMOD/Lua/Shops/</span>.
				<br><br>A shop can be loaded with this function:
                <span class="function">General.EnterShop(<span class="string"></span> scriptName)</span>
                Enters a shop scene from the overworld.<br>
                <span class="term">scriptName</span> should be the name of your shop's lua file, without the extension.
				<br>So, if you have want to load <span class="term">YOURMOD/Lua/Shops/shop.lua</span>, you would use
				<span class="term">General.EnterShop("shop")</span>.
			</p>

            <hr>
			<h3>Shop variables</h3>
            <br>

			<p>
				<ul>
					<li><span class="userdata">sprite</span> <span class="term">background</span> - A sprite object used as the background of the shop. Optimally, this sprite should be 640x240 pixels.</li>
                    <br>
					<li><span class="string"></span> <span class="term">returnscene</span> - The name of the scene the Player will go back to when exiting the shop.</li>
                    <br>
					<li><span class="luatable"><span class="number"></span>, <span class="number"></span></span> <span class="term">returnpos</span> - A table containing the position the Player will appear at in the map when leaving the shop.</li>
                    <br>
					<li><span class="number"></span> <span class="term">returndir</span> - Direction the Player will face when returned to the overworld.<br>
                    Possible values:
                    <ul>
                        <li><span class="term">2</span>: Down</li>
                        <li><span class="term">4</span>: Left</li>
                        <li><span class="term">6</span>: Right</li>
                        <li><span class="term">8</span>: Up</li>
                    </ul>
					</li>
                    <br>
					<li><span class="string"></span> <span class="term">music</span> - Name of the music file the shop will use. The music file must be .ogg or .wav and must be in
					<span class="term">YOURMOD/Audio</span>.</li>
					<br>
					<li><span class="luatable"><span class="luatable"><span class="string"></span></span>,
                    <span class="luatable"><span class="string"></span></span>, <span class="luatable"><span class="number"></span></span></span> <span class="term">buylist</span> - A table defining which items the shop will have in store.<br>
                    This table is composed of 3 other tables:
						<ul>
							<li>The first table contains the names of the items to be sold.<br>
                            The items must be in the item database (<span class="term">CYF/Scripts/Inventory/Inventory.cs</span>).</li><br>
							<li>The second table contains the descriptions for each item.</li><br>
							<li>The third table contains the prices of each item.<br>
                            Use -1 to use the price set in the database (<span class="term">CYF/Scripts/Inventory/Inventory.cs</span>).<br>
                            <span class="new"></span>Use 0 to make the item display as "--- SOLD OUT ---" like in Undertale. The player will not be able to buy it.</li>
						</ul>
					</li>
                    <br>
					<li><span class="luatable"><span class="luatable"><span class="string"></span></span>,
                    <span class="luatable"><span class="luatable"><span class="string"></span></span> or <span class="string"></span></span></span> <span class="term">talklist</span> - A table containing the list of all the talk options in the shop. This table is composed of 2 other tables:
						<ul>
							<li>The first table contains the name of each TALK option the Player can pick.</li>
							<li>The second table contains the text associated with these TALK actions. These can each be a single string or a table of
							strings.</li>
						</ul>
                        <br>
                        Example setup:
                        <div class="code-container">
                        <pre class="brush: lua;">
talklist = {
    { "Job", "Hobbies", "Threaten", "Sell?" },
    {
        { "Me?", "I'm just a shopkeeper." },
        "Just a shopkeeper.",
        { "Threats? I'm not impressed, I'm just a shopkeeper." },
        { "So you have items to sell?",
          "I guess some of them could be useful to me...",
          "Alright, I'll see what you have next time you want to sell something to me!" }
    }
}
                        </pre>
                        </div>
					</li>
					<br>
					<li><span class="string"></span> <span class="term">maintalk</span> - The text displayed in the main Shop menu.</li>
                    <br>
					<li><span class="string"></span> <span class="term">buytalk</span> - The text displayed when entering the Buy menu.</li>
                    <br>
					<li><span class="string"></span> <span class="term">talktalk</span> - The text displayed when entering the Talk menu.</li>
                    <br>
					<li><span class="string"></span> <span class="term">exittalk</span> - The text displayed when entering the Exit menu.</li>
                    <br>
                    <li><span class="new"></span><span class="boolean"></span> <span class="term">playerskipdocommand</span> - False by default. If this value is
                    set to true, text commands will be called even if the player skips the text - except for <span class="term">[w]</span> and
                    <span class="term">[letters]</span> commands, and commands with the tag "<span class="term">skipover</span>".</li>
				</ul>
			</p>

            <hr>
			<h3>Shop events</h3>
			<br>

            These events work the same way as events work in-battle. See <span class="ref">Game events</span>.

            <p>
                <br><span class="function">Start()</span>
				This event is called when entering the shop.
				<br>It is advised to set the background's image here.
            </p>

            <p>
                <br><span class="function">Update()</span>
				Every well-functioning script needs an Update() function.<br>
				This function is called once per frame.
            </p>

            <p>
                <br><span class="function">EnterMenu()</span>
				Entered when entering the main Shop menu.
            </p>

            <p>
                <br><span class="function">EnterBuy()</span>
				Entered when entering the Buy menu.
            </p>

            <p>
                <br><span class="function">SuccessBuy(<span class="string"></span> itemName)</span>
				Entered when an item is successfully purchased.
				<br><span class="term">itemName</span> is the name of the item bought.
            </p>

            <p>
                <br><span class="function">FailBuy(<span class="string"></span> error)</span>
				Entered when the Player tries to buy an item, but can't.
				<br><span class="term">error</span> has two possible values:
				<ul>
					<li><span class="term">"gold"</span> - If the Player doesn't have enough Gold.</li>
					<li><span class="term">"full"</span> - If the Player's inventory is full.</li>
					<li><span class="new"></span><span class="term">"soldout"</span> - If the shop is sold out of this item.<br>
                    See <span class="term">buylist</span> for how to accomplish this.</li>
				</ul>
            </p>

            <p>
                <br><span class="function">ReturnBuy()</span>
				Entered when the player selects an item to buy, then chooses "No" or presses the Cancel button.
            </p>

            <p>
                <br><span class="function">EnterSell()</span>
				Entered when entering the Sell menu.
				<br>To prevent the player from selling, use the function <span class="term">Interrupt()</span> here (see below).
            </p>

            <p>
                <br><span class="function">SuccessSell(<span class="string"></span> itemName)</span>
				Entered when an item is successfully sold.
				<br><span class="term">itemName</span> is the name of the item sold.
            </p>

            <p>
                <br><span class="function new">FailSell(<span class="string"></span> error)</span>
				Entered when failing to enter or use the Sell menu.
                <br><span class="term">error</span> has two possible values:
				<ul>
					<li><span class="term">"empty"</span> - If the Player's inventory is empty.</li>
					<li><span class="term">"cantsell"</span> - If the Player tries to sell an item, but it is unsellable.<br>
                    In order to accomplish this, set the item's sell price to 0 in the database (<span class="term">CYF/Scripts/Inventory/Inventory.cs</span>).</li>
				</ul>
            </p>

            <p>
                <br><span class="function">ReturnSell()</span>
				Entered when the player selects an item to sell, then chooses "No" or presses the Cancel button.
            </p>

            <p>
                <br><span class="function">EnterTalk()</span>
				Entered when entering the Talk menu.
            </p>

            <p>
                <br><span class="function">SuccessTalk(<span class="string"></span> talkOption)</span>
				Entered when a Talk option is successfully selected.
				<br><span class="term">talkOption</span> is the name of the option selected.
            </p>

            <p>
                <br><span class="function">EnterExit()</span>
				Entered when choosing the Exit option.
            </p>

			<p>
                <br><span class="function">Interrupt(<span class="luatable"><span class="string"></span></span> text, <span class="string"></span> newState = "MENU")</span>
                Interrupts any current state (except the <span class="term">INTERRUPT</span> state) to display the message given in
                <span class="term">text</span>.<br>
				At the end of the message, the state <span class="term">newState</span> will be entered.<br><br>
				<i>I advise for you to not use this to enter the states</i> <span class="term">BUYCONFIRM</span>,
				<span class="term">SELLCONFIRM</span> <i>or</i> <span class="term">TALKINPROGRESS</span>.
            </p>

			<p>
                <br><span class="function">OnInterrupt(<span class="string"></span> newState)</span>
				This function is called when entering the Interrupt state.
				<br><span class="term">newState</span> is the name of the state the Player will enter when the
				Interrupt state finishes its text.<br>
            </p>

            <hr>
			<h3>Additional info</h3>
            <br>

			<p>
				The layers in the Shop scene aren't the same as everywhere else.<br>
                This is the Shop script's layering system:
				<ul>
				    <li><span class="term">"Bottom"</span>: Under everything, even the background.</li><br>
				    <li><span class="term">"BelowUI"</span>: Above the background.</li><br>
				    <li><span class="term">"BelowPlayer"</span>: Above the background and the UI.</li><br>
				    <li><span class="term">"Top"</span>: Above everything.</li><br>
				</ul>
			</p>
		</div>

		<div class="tab-pane text-style" id="mercy">
            <h2 style="text-decoration: none; line-height:50px;">
                * YOU WON!<br>
                * You earned 0 EXP and 0 gold.<br>
                * also the nav menu is broken now
            </h2><br>
        </div>
	</div>
</div>

<div class="container">
    <div class="col-xs-3"><img class="centerbt black" alt="Undertale fake button" src="../img/fightbt_0.png" height="42">
    </div>
    <div class="col-xs-3"><img class="centerbt black" alt="Undertale fake button" src="../img/actbt_0.png" height="42">
    </div>
    <div class="col-xs-3"><img class="centerbt black" alt="Undertale fake button" src="../img/itembt_0.png" height="42">
    </div>
    <div class="col-xs-3"><a href="#mercy" data-toggle="tab"><img class="centerbt black" alt="Undertale fake button"
                                                                  src="../img/mercybt_0.png" height="42"></a>
    </div>
</div>
<br>
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script type="text/javascript" src="../js/show_hide_comments.js"></script>

<script type="text/javascript" src="../js/FontToggleButton.js"></script>
</body>
</html>