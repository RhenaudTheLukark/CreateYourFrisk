<!DOCTYPE html>
<!--
since you're here anyway: there's a small easter egg on the text commands page but it's probably not worth finding, sorry
you may notice this page's code is garbage: i'm not a web designer! ;-;
it's w3c valid, at least
-->

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>CYF Documentation - How to create a map in Unity with Tiled2Unity</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/bootstrap-theme.min.css" rel="stylesheet">
    <link href="../css/themesidebar.css" rel="stylesheet">
    <link href="../css/shThemeRDark.css" rel="stylesheet">
</head>
<body>
<img src="../img/bg2.png" alt="Undertale background" class="backimg">
<div class="container arena black">
    <div class="col-md-2">
        <!--navigation-->
        <nav class="nav-sidebar">
            <ul class="nav tabs">
                <li class="li-header">Basics</li>
                    <li><a href="../documentation.html">Welcome</a></li>
                    <li><a href="howtoread.html">How to read this documentation</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li><a href="controls.html">Controls</a></li>
                    <li><a href="basic.html">Basic setup</a></li>
                    <li><a href="unity.html"><span class="CYF"></span> Unity Setup (Optional)</a></li>
                    <li class="new066"><a href="variables.html">Special Variables</a></li>
                    <li><a href="terms.html">Terminology</a></li>
                <li class="li-header">API</li>
                    <li class="new066"><a href="api-text.html">Text commands</a></li>
                    <li class="new066"><a href="api-events.html">Game events</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li class="li-indent">Functions &amp; Objects:</li>
                        <li class="new066 li-indent"><a href="api-functions-main.html">Misc. Functions</a></li>
                        <li class="li-indent new066"><a href="api-functions-player.html">The Player Object</a></li>
                        <li class="li-indent"><a href="api-functions-script.html">The Script Object</a></li>
                        <li class="li-indent"><a href="api-functions-audio.html">The Audio Object</a></li>
                        <li class="li-indent"><a href="api-functions-newaudio.html"><span class="CYF"></span> The NewAudio Object</a></li>
                        <li class="li-indent"><a href="api-functions-input.html">The Input Object</a></li>
                        <li class="new066 li-indent"><a href="api-functions-time.html">The Time Object</a></li>
                        <li class="new066 li-indent"><a href="cyf-inventory.html"><span class="CYF"></span> The Inventory Object</a></li>
                        <li class="new066 li-indent"><a href="api-functions-misc.html"><span class="CYF"></span>The Misc Object</a></li>
                        <li class="li-indent new"><a href="api-functions-discord.html"><span class="CYF"></span> The Discord Object</a></li>
                        <li class="new066 li-indent"><a href="api-functions-waves.html">The Arena Object</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li class="new066"><a href="api-projectile.html">Projectile management</a></li>
                    <li><a href="cyf-ppcollision.html"><span class="CYF"></span> The Pixel-Perfect Collision System</a></li>
                    <li class="new066"><a href="api-animation.html">Sprites &amp; Animation</a></li>
                    <li class="new066"><a href="cyf-text.html"><span class="CYF"></span> The Text Object</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                <li class="li-header"></span><span class="CYF"></span> <span class="new"></span>Shaders</li>
                    <li><a href="shaders.html">Introduction</a></li>
                    <li><a href="shaders-object.html">The Shader Object</a></li>
                    <li><a href="shaders-coding.html">Coding a Shader</a></li>
                    <hr style="margin-top:10px;margin-bottom:10px;">
                <li class="li-header"><span class="CYF"></span> Overworld</li>
                    <li class="new"><a href="overworld.html">Basics</a></li>
                    <li class="active" style="margin-left:5px;">&gt; How to create a map &lt;</li>
                    <li><a href="overworld-howto-event.html">How to create an event</a></li>
                    <li><a href="overworld-howto-animevent.html">How to animate an event</a></li>
                    <li class="new"><a href="overworld-howto-shop.html">How to create a shop</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                    <li class="li-indent"><span class="CYF"></span> Overworld Objects:</li>
                        <li class="li-indent"><a href="overworld-object-general.html">The General Object</a></li>
                        <li class="li-indent"><a href="overworld-object-event.html">The Event Object</a></li>
                        <li class="li-indent"><a href="overworld-object-player.html">The Player Object</a></li>
                        <li class="li-indent"><a href="overworld-object-screen.html">The Screen Object</a></li>
                        <li class="li-indent"><a href="overworld-object-inventory.html">The Inventory Object</a></li>
                        <li class="li-indent new"><a href="overworld-object-map.html">The Map Object</a></li>
                    <hr style="margin-top:-2.5px;margin-bottom:2.5px;">
                <li class="li-header">Resources</li>
                    <li><a href="../media/dialogoptions.png">Dialog bubble names</a></li>
                    <li><a href="api-keys.html"><span class="CYF"></span> Key List</a></li>
            </ul>
        </nav>
    </div>
    <!--tabs'n'shit-->
    <div class="tab-content col-md-10">
        <div class="tab-pane active text-style" id="overworld-howto-map">
            <h2><span class="CYF"></span> The Overworld: How to create a map in Unity with Tiled2Unity</h2><br><br>

            <p>
                Creating a map for CYF is not that difficult. All that you need to do is follow the rules.
                There are a lot of them, but as long as you stick to them, you'll be fine.
            </p>

            <p>
                The very first step is to create the map in Tiled, and save it.<br>
                <u>Tip:</u> Undertale's tiles are 20x20 pixels, with a scale factor of 2: I suggest for you to
                make a tileset of 40x40px tiles so you will not have to worry about scaling.
            </p>

            <br><img src="../img/Tiled2Unity screenshot.png" alt="Tiled2Unity screenshot"><br><br>
            <p>
                <li>Open Tiled2Unity.exe</li>
                <li><span class="term">File</span> --> Choose your .tmx file</li>
                <li><span class="term">Export To</span> --> <span class="term">PathToCYF\Assets\Tiled2Unity\Tiled2Unity.export.txt</span></li>
                <li>Click the <span class="term">Big Ass Export Button</span></li>
                <li>Close Tiled2Unity and open Unity</li>
            </p>
            <br>
            <p>
                <li>Now that you're in Unity, you should create a scene, then delete the Main Camera object, save and then name the map
                (the name will be important!)</li>
                <li>Open the scene <span class="term">Assets\Scenes\test4.unity</span>, copy all its contents and paste them into your newly
                created scene.</li>
                <li>In the <span class="term">Project</span> tab, go to <span class="term">Assets\Tiled2Unity\Prefabs</span> and you should
                see your map. Drag and drop it over the scene. (Put it in the root, not in a directory)</li>
                <li>Go to <span class="term">Assets\Resources\Prefabs</span> and include <span class="term">Main Camera OW</span> like you
                did in the previous  line. Now you should be able to see something in the Game tab!</li>
            </p>
            <br>
            <p>
                <li>Remove the map in <span class="term">Background</span>, disable the objects <span class="term">Foreground</span> and
                <span class="term">Bottom</span> by clicking on each object, going to the Inspector and unchecking the box right next to the
                object's name.</li>
                <li>Move your map so that the bottom-left corners of the map and the camera are at the same coordinates.</li>
                <li>Delete everything that is in the GameObject <span class="term">Background</span>, except for the TPs. You'll see that
                  your map object is composed of every layer that you've added in your map.</li>
                 <li>Now, inside of <span class="term">Background</span>, you'll have to insert the main object component of your map and
                  its colliders (in your object layers).<br>
                  If Unity asks you if you want to break the prefab, say "Yes".</li>
                <li>If there are other layers, just put them in the root.</li>
                <li>Delete the object which contained all the map elements.</li>
            </p>
            <br>
            <p>
                <li>Adjust so that <span class="term">Background</span>'s RectTransform fits in the map. It's very important,
                    as the RectTransform bounds are used for map scrolling.<br>
                  <u>Tips:</u>
                  <ul>
                      <li>Put all of <span class="term">Background</span>'s children in the root or as the children of another object, so
                        that their position isn't changed while the background moves.</li>
                      <li>Then, <span class="term">Background</span>'s RectTransform size will be equal to (the bounds of the map / 100) - so,
                        if your map is 640x480, the size will be 6.4 by 4.8.</li>
                      <li>Now, center the main map object to make it fit inside of <span class="term">Background</span>'s
                      <span class="term">RectTransform</span>.</li>
                      <li>Don't forget that <span class="term">Background</span>'s <span class="term">RectTransform</span>'s bottom-left corner
                        must be at the same coordinates as the <span class="term">Main Camera OW</span>'s
                        <span class="term">RectTransform</span>'s bottom-left corner!</li>
                      <li>Now, when everything is all done, put <span class="term">Background</span>'s old children back to their original places
                      as <span class="term">Background</span>'s children.</li>
                  </ul></li>
                  <br>NOTE: The absolute minimum size for a map for the camera to function properly is 640x480.
            </p>
            <br>
            <p>
                <li>For each map component, go to the component <span class="term">Sorting Layer Exposed</span> and set the value
                  <span class="term">Order in Layer</span> to 0.</li>
                <li>For each map component, you'll need to set the Z value of the map. The Z value works like
                  this: the greater it is, the further into the background a component will be.<br>
                  Set <span class="term">Background</span>'s Z value to 140, then play around this value to set the Z value of other
                  background layers (between 139 and 141; you can use decimal numbers, of course).<br>
                  For foreground layers' Z values, you should use values between -1.5 and -0.5.<br>
                  <u>Warning</u>: The maps' Z value must be set to 0 after setting the layers' Z values!</li>
            </p>
            <br>
            <p>
                <li>Edit, add and/or remove the TP objects. You'll have to set some values for the TP: see the
                  component <span class="term">TP Handler</span>.
                  <ul>
                      <li><span class="term">Scene Name</span> = Name of the destination scene of the TP.</li>
                      <li><span class="term">Position</span> = Position of the player in the destination map, from the bottom-left corner of
                      the map.</li>
                      <li><span class="term">Direction</span> = Direction the player will be facing after the TP. <span class="term">2</span> = Down,
                      <span class="term">4</span> = Left, <span class="term">6</span> = Right, <span class="term">8</span> = Up.<br>
                      (I used the NumPad for this, yeah ^^)</li>
                      <li><span class="term">Activated</span> = Boolean used when the TP is activated. Don't activate it manually!</li>
                  </ul></li>
            </p>
            <br>
            <p>
                <li>Change the layer of all of the colliders. Give them the layer <span class="term">BlockingLayer</span>.<br>
                  <u>Tip:</u> Select the first one, then shift-click on the last one. Then, you can change the
                      layer of all objects simultaneously!</li>
                <li>Finally, modify the data in the object <span class="term">Background</span>, in the <span class="term">Map Info</span> Component.
                  <ul>
                      <li><span class="term">Music</span> = Name of the BGM played on the map. The BGM must be in the <span class="term">Audio</span>
                      folder of the mod or the <span class="term">Default</span> folder.</li>
                      <li><span class="term">Mod To Load</span> = Name of the mod loaded by the map.</li>
                      <li><span class="term">Is Music Kept Between Battles</span> = Makes the Overworld music keep playing during battles
                      (like the CORE in Undertale). If unsure, leave unchecked.</li>
                      <li><span class="term">No Random Encounter</span> = Check to disable random encounters on your map. If left unchecked, random
                      encounters will occur, by randomly choosing an encounter .lua file from the mod set in <span class="term">Mod To Load</span>.
                      Will exclude any encounters whose names start with <span class="term">#</span>.</li>
                  </ul></li>
                <li>When everything is ready, remove the <span class="term">Main Camera OW</span> object and save the map.</li>
            </p>
            <hr>
            <p>
                <h4>Now, it's time to test it!</h4><br><br>
                Your map is now ready! But it isn't playable yet...Before testing it, we'll need to add it to the Build.<br><br>
                When you're on your newly created map, open <span class="term">File</span> --> <span class="term">Build Settings</span>...<br>
                Click on the button <span class="term">Add Open Scenes</span> while you're on your map. It should now be in the list of Scenes in the
                Build. It'll be built with the project and it can now be used!
            </p><br>
            <p>
                <li>Open the scene <span class="term">Assets\Scenes\TransitionOverworld.unity</span> and search for the GameObject
                  <span class="term">Main Camera OW</span>.<br>
                  <li>Go to the component <span class="term">Transition Overworld</span> and change the values.</li>
                  <ul>
                  <li><span class="term">First Level To Load</span>: Name of the first scene to load.</li>
                  <li><span class="term">Beginning Position</span> = Position of the player in the first map, from the bottom-left corner
                        of the map.</li>
                  </ul>
              </li>
              <li>Load the scene <span class="term">Disclaimer.unity</span> and launch the game.<br>
                Start a new game if you've already saved.<br><br>
                You should now be in your map!</li>
            </p>
            <br>
            <p>
                Run some tests on the map if there are problems.<br>
                If there are no problems, you can now move on to adding events!<br><br>
            </p>
            <hr>
            <p>
                If you had any problems with this tutorial, please tell me what went wrong.<br>
                If you see any ways that this tutorial can be improved, please tell me that as well.<br>
                You'll have more chances to contact me on Unitale's Discord server - the response will be way faster and it will be much
                smoother than using messages on reddit.<br>
                Here is the link to the <a href="https://discord.gg/0c8fN7KCwBh4ZBL9">Discord server</a>.
            </p>
            <br>
            <p>
                I hope that you enjoyed the tutorial! If you're ready to add an event, go to the next tutorial!
            </p>
        </div>

        <div class="tab-pane text-style" id="mercy">
            <h2 style="text-decoration: none; line-height:50px;">
                * YOU WON!<br>
                * You earned 0 EXP and 0 gold.<br>
                * also the nav menu is broken now
            </h2><br>
        </div>
    </div>
</div>

<div class="container">
    <div class="col-xs-3"><img class="centerbt black" alt="Undertale fake button" src="../img/fightbt_0.png" height="42">
    </div>
    <div class="col-xs-3"><img class="centerbt black" alt="Undertale fake button" src="../img/actbt_0.png" height="42">
    </div>
    <div class="col-xs-3"><img class="centerbt black" alt="Undertale fake button" src="../img/itembt_0.png" height="42">
    </div>
    <div class="col-xs-3"><a href="#mercy" data-toggle="tab"><img class="centerbt black" alt="Undertale fake button"
                                                                  src="../img/mercybt_0.png" height="42"></a>
    </div>
</div>
<br>
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script type="text/javascript" src="../js/show_hide_comments.js"></script>

<script type="text/javascript" src="../js/FontToggleButton.js"></script>
</body>
</html>